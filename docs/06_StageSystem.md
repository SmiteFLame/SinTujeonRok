# 🗺️ #6 관문(關門) / 진행 구조 설계

> **관련 이슈:** #6
> **버전:** v0.1
> **최종 수정일:** 2026-02-22
> **용어 기준:** [Terminology.md](Terminology.md) 참조

---

## 1. 전체 진행 구조

### 스토리 진행 = 관문 돌파

```
┌──────────────────────────────────────────────────────┐
│                                                      │
│  제1장 한양 (관문 1~12)                               │
│   ├─ 잡몹 관문 ×10                                   │
│   ├─ 중간 두목(頭目) ×1  [관문 6]                     │
│   └─ 장(章) 두목 ×1     [관문 12]  ← 스토리 진행      │
│       ↓                                              │
│  제2장 경기 (관문 13~24)                              │
│   ├─ 잡몹 관문 ×10                                   │
│   ├─ 중간 두목 ×1  [관문 18]                          │
│   └─ 장 두목 ×1    [관문 24]                          │
│       ↓                                              │
│  제3장 호서 (관문 25~36) → ... → 제8장 한양 귀환       │
│       ↓                                              │
│  엔드 콘텐츠 (관문 97+)                               │
│   ├─ 무한 투전탑                                      │
│   ├─ 일일 시련                                       │
│   ├─ 패사 대전                                       │
│   └─ 절기(節氣) 콘텐츠                                │
│                                                      │
└──────────────────────────────────────────────────────┘
```

### 장(章)별 관문 배치

| 장 | 지역 | 관문 범위 | 잡몹 | 중간 두목 | 장 두목 | 품계 |
|----|------|----------|------|----------|--------|------|
| 1장 | 한양 | 1~12 | 10 | 관문 6 | 관문 12 | 1~3품 |
| 2장 | 경기 | 13~24 | 10 | 관문 18 | 관문 24 | 4~6품 |
| 3장 | 호서 | 25~36 | 10 | 관문 30 | 관문 36 | 7~9품 |
| 4장 | 호남 | 37~48 | 10 | 관문 42 | 관문 48 | 10~12품 |
| 5장 | 영남 | 49~60 | 10 | 관문 54 | 관문 60 | 13~15품 |
| 6장 | 관북 | 61~72 | 10 | 관문 66 | 관문 72 | 16~18품 |
| 7장 | 관서 | 73~84 | 10 | 관문 78 | 관문 84 | 19~21품 |
| 8장 | 한양 귀환 | 85~96 | 10 | 관문 90 | 관문 96 | 22~24품 |
| **합계** | | **96관문** | **80** | **8** | **8** | |

---

## 2. 관문 유형

### 2-1. 잡몹 관문

```
적 구성: 2~5체 (관문 번호에 따라 증가)
적 품계: 해당 장(章)의 품계 범위 내
패결 방식: 일반 자동 패결 (30수 제한)

잡몹 관문 내부 변화:
  관문 1~3:  적 2체 (튜토리얼)
  관문 4~6:  적 3체
  관문 7~9:  적 4체
  관문 10~11: 적 5체
  관문 12:   장 두목 (1체, 고기력)
```

### 2-2. 중간 두목 관문

```
등장: 각 장의 6번째 관문 (관문 6, 18, 30, 42, 54, 66, 78, 90)
적 구성: 중간 두목 1체 + 부하 2체
특징:
  - 두목 기력 = 잡몹 ×5
  - 고유 기운(氣韻) 1개 보유
  - 분노 게이지 없음
  - 페이즈 1단계만
보상: 은냥 ×3 + 패편 보너스 + 해당 지역 패 1장 (첫 돌파 시)
```

### 2-3. 장(章) 두목 관문

```
등장: 각 장의 마지막 관문 (관문 12, 24, 36, 48, 60, 72, 84, 96)
적 구성: 장 두목 1체
특징:
  - 두목 기력 = 잡몹 ×10
  - 고유 기운(氣韻) 2개 보유
  - 분노 게이지 활성
  - 페이즈 2~3단계
  - 스토리 컷신 포함
보상: 은냥 ×5 + 각성석 + 해당 지역 핵심 패 (첫 돌파 시)
      + 다음 장 해금
```

---

## 3. 난이도 곡선

### 적 전투력 스케일링

```
적_전투력 = 기준전투력 × 관문계수

기준전투력 = 100 (관문 1 기준)

관문계수:
  관문  1: ×1.0        (전투력 100)
  관문 12: ×3.0        (전투력 300)      ← 1장 두목
  관문 24: ×8.0        (전투력 800)      ← 2장 두목
  관문 36: ×18.0       (전투력 1,800)    ← 3장 두목
  관문 48: ×40.0       (전투력 4,000)    ← 4장 두목
  관문 60: ×85.0       (전투력 8,500)    ← 5장 두목
  관문 72: ×180.0      (전투력 18,000)   ← 6장 두목
  관문 84: ×400.0      (전투력 40,000)   ← 7장 두목
  관문 96: ×1,000.0    (전투력 100,000)  ← 최종 두목
```

### 난이도 곡선 그래프 (개념)

```
전투력
  │
  │                                          ╱ 관문 96
  │                                        ╱   (×1,000)
  │                                      ╱
  │                                   ╱
  │                               ╱
  │                           ╱
  │                       ╱
  │                  ╱
  │            ╱╱
  │       ╱╱
  │  ╱╱
  │╱
  └──────────────────────────────── 관문
   1    12   24   36   48   60   72   84   96

→ 지수적(Exponential) 성장 곡선
→ 중반(4~5장)부터 연마/각성 없이는 진행 불가
→ 후반(7~8장)은 신물 해금 수준의 공력 필요
```

### 권장 전투력 & 체감 난이도

| 관문 구간 | 권장 전투력 | 체감 | 예상 소요 |
|----------|-----------|------|----------|
| 1~12 (한양) | 100~300 | 쉬움 (튜토리얼) | Day 1 |
| 13~24 (경기) | 300~800 | 보통 (기본기) | Day 2~4 |
| 25~36 (호서) | 800~1,800 | 어려움 (전략 필요) | Day 5~10 |
| 37~48 (호남) | 1,800~4,000 | 어려움 (연마 필수) | Day 11~20 |
| 49~60 (영남) | 4,000~8,500 | 매우 어려움 | Day 21~35 |
| 61~72 (관북) | 8,500~18,000 | 극한 | Day 36~55 |
| 73~84 (관서) | 18,000~40,000 | 극한 | Day 56~75 |
| 85~96 (한양 귀환) | 40,000~100,000 | 최종 | Day 76~90 |

---

## 4. 관문 보상

### 4-1. 일반 관문 돌파 보상 (매회)

```
돌파 보상 = 기본보상 × 관문_보정

기본보상:
  은냥:   50
  수련치: 30

관문_보정 = 1.0 + (관문번호 - 1) × 0.03
```

| 관문 | 은냥 | 수련치 |
|------|------|--------|
| 1 | 50 | 30 |
| 12 | 67 | 40 |
| 24 | 85 | 51 |
| 48 | 121 | 72 |
| 72 | 156 | 94 |
| 96 | 193 | 116 |

### 4-2. 첫 돌파 보상 (1회성)

| 관문 유형 | 첫 돌파 보상 |
|----------|------------|
| **일반 잡몹** | 은냥 ×5 + 범 패편 3~5 |
| **중간 두목** | 은냥 ×10 + 해당 지역 패 1장 + 수 패편 5 |
| **장 두목** | 은냥 ×20 + **핵심 패 1장** + 각성석 1 + 옥패 30 |

### 4-3. 장(章) 돌파 보상 (스토리)

| 장 | 두목 | 핵심 보상 |
|----|------|----------|
| 1장 한양 | 흑패단 하수인 | 패 "장사(壯士)" 각성 재료 + 별호 "한양의 패사" |
| 2장 경기 | 흑패단 간부 | 개봉권 3장 + 별호 "경기의 유망주" |
| 3장 호서 | 흑패단 사천왕 | 각성석 3 + 별호 "호서의 패검객" |
| 4장 호남 | 전설의 타짜 | 걸 패편 10 + 별호 "호남의 타짜" |
| 5장 영남 | 흑패단 부수장 | 각성석 5 + 옥패 100 + 별호 "영남의 패왕" |
| 6장 관북 | 북방 수련자 | 각성석 8 + 별호 "관북의 도인" |
| 7장 관서 | 흑패단 참모 | 각성석 10 + 옥패 200 + 별호 "관서의 현자" |
| 8장 한양 귀환 | **흑수** | 각성석 15 + 옥패 500 + 별호 **"투전의 신"** |

---

## 5. 관문 내 적 구성

### 적 종류

| 적 유형 | 기호 | 특징 |
|---------|------|------|
| **잡몹** | 🟢 | 기본 적, 특별한 능력 없음 |
| **정예** | 🟡 | 잡몹 ×2 스탯, 기운 1개 보유 |
| **중간 두목** | 🟠 | 잡몹 ×5 스탯, 기운 1개, 술 강화 |
| **장 두목** | 🔴 | 잡몹 ×10 스탯, 기운 2개, 분노 게이지, 페이즈 |

### 관문별 적 구성 예시 (1장 한양)

| 관문 | 적 구성 | 전투력 | 특이사항 |
|------|---------|--------|---------|
| 1 | 🟢×2 | 100 | 튜토리얼 - 자동 승리 |
| 2 | 🟢×2 | 120 | 술(術) 사용 안내 |
| 3 | 🟢×3 | 150 | 패진 편성 안내 |
| 4 | 🟢×3 | 180 | 합(合) 시스템 안내 |
| 5 | 🟢×3 + 🟡×1 | 220 | 정예 첫 등장 |
| **6** | **🟠×1 + 🟢×2** | **280** | **중간 두목** |
| 7 | 🟢×4 | 200 | 난이도 소폭 하락 (회복 구간) |
| 8 | 🟢×3 + 🟡×1 | 240 | - |
| 9 | 🟢×4 + 🟡×1 | 270 | - |
| 10 | 🟡×2 + 🟢×2 | 280 | 정예 2체 |
| 11 | 🟡×2 + 🟢×3 | 290 | 두목전 준비 |
| **12** | **🔴×1** | **300** | **장 두목: 흑패단 하수인** |

### 지역별 적 속성 경향

| 지역 | 주요 적 패 종류 | 주의 상태이상 |
|------|----------------|-------------|
| 한양 | 인(人), 어(魚) | 맹독 |
| 경기 | 조(鳥), 마(馬) | 둔화 |
| 호서 | 어(魚), 성(星) | 속박 |
| 호남 | 인(人), 장(獐) | 혼미 |
| 영남 | 마(馬), 치(雉) | 화독 |
| 관북 | 성(星), 토(兎) | 경직 |
| 관서 | 장(獐), 조(鳥) | 안개 + 봉인 |
| 한양 귀환 | 전 종류 혼합 | 전 상태이상 |

---

## 6. 튜토리얼 연동 (1장 한양)

### 관문별 튜토리얼 안내

| 관문 | 신규 해금 | 튜토리얼 내용 |
|------|----------|-------------|
| 1 | 패결(牌決) | "패결이란 무엇인가" - 자동 패결 체험 |
| 2 | 술(術) | "술의 사용법" - 술 발동 확인 |
| 3 | 패진(牌陣) | "패진을 편성하라" - 패진 편집 체험 |
| 4 | 합(合) | "같은 패의 힘 - 합" - 합 시스템 안내 |
| 5 | 연마(鍊磨) | "패를 갈고 닦아라" - 첫 연마 체험 |
| 6 | 두목(頭目) | "강적을 쓰러뜨려라" - 중간 두목 패결 |
| 7 | 방치 수련 | "오프라인에서도 수련은 계속된다" |
| 8 | 개봉(開封) | "봉인된 패를 개봉하라" - 무료 개봉 체험 |
| 9 | 비기(秘技) | "패의 조합 - 비기" - 비기 시스템 안내 |
| 10 | 일과(日課) | "매일의 일과" - 일과 시스템 해금 |
| 11 | 패보(牌譜) | "수집의 기록" - 패보 시스템 해금 |
| 12 | 스토리 | 1장 두목전 + 2장 해금 |

---

## 7. 언락(해금) 시스템

### 콘텐츠 해금 조건

| 콘텐츠 | 해금 조건 | 관문 |
|--------|----------|------|
| 패진(牌陣) 편성 | 관문 3 돌파 | 3 |
| 연마(鍊磨) | 관문 5 돌파 | 5 |
| 개봉(開封) | 관문 8 돌파 | 8 |
| 일과(日課) | 관문 10 돌파 | 10 |
| 패보(牌譜) | 관문 11 돌파 | 11 |
| 2장 (경기) | 관문 12 돌파 (1장 두목) | 12 |
| 배속 ×2 | 관문 12 돌파 | 12 |
| 객주(客主) | 관문 15 돌파 | 15 |
| 각성(覺醒) | 관문 20 돌파 | 20 |
| 패사 대전 | 관문 24 돌파 (2장 두목) | 24 |
| 배속 ×3 | 관문 36 돌파 | 36 |
| 무한 투전탑 | 관문 48 돌파 (4장 두목) | 48 |
| 일일 시련 | 관문 36 돌파 (3장 두목) | 36 |
| 절기 콘텐츠 | 관문 60 돌파 (5장 두목) | 60 |
| **엔드 콘텐츠 전체** | 관문 96 돌파 (최종 두목) | 96 |

### 기능 해금 흐름

```
Day 1 (관문 1~12):
  ├─ 패결 → 패진 → 연마 → 개봉 → 일과 → 패보
  └─ 기본 시스템 모두 해금

Day 2~4 (관문 13~24):
  ├─ 객주 → 각성 → 패사 대전
  └─ 소셜/경쟁 콘텐츠 해금

Day 5~20 (관문 25~48):
  ├─ 배속×3 → 일일 시련 → 무한 투전탑
  └─ 반복/도전 콘텐츠 해금

Day 21+ (관문 49~96):
  ├─ 절기 콘텐츠 → 엔드 콘텐츠
  └─ 장기 플레이 콘텐츠 해금
```

---

## 8. 관문 반복 & 소탕

### 반복 패결

```
돌파한 관문은 무한 반복 가능:
  - 은냥, 수련치, 패편 획득 (첫 돌파 보상은 1회만)
  - 방치 수련의 액티브 버전
  - 액티브 반복 효율 = 방치 대비 ×1.5~2.0
```

### 소탕(즉시 완료)

```
조건: 이미 돌파한 관문
효과: 패결 없이 즉시 보상 획득
비용: 무료 (일일 제한 없음)
보상: 일반 돌파 보상과 동일

소탕 해금: 관문 12 돌파 후 (1장 클리어)
```

### 자동 진행

```
설정에서 ON/OFF:
  - ON: 관문 돌파 시 자동으로 다음 관문 도전
  - OFF: 돌파 후 결과 화면에서 멈춤

자동 중지 조건:
  - 패(敗) 시 자동 중지
  - 두목 관문 도달 시 자동 중지 (스토리 확인 유도)
  - 기력 경고 시 자동 중지 (2연패 시)
```

---

## 9. 엔드 콘텐츠 상세

### 9-1. 무한 투전탑

> 상세 규칙은 [04_BattleSystem.md](04_BattleSystem.md) 참조

```
해금: 관문 48 돌파 (4장 두목)
구조: 1층부터 무한히 올라가는 탑

층수별 보상:
  1~10층:  은냥 500/층 + 범 패편 2
  11~20층: 은냥 1,000/층 + 수 패편 2
  21~50층: 은냥 2,000/층 + 수 패편 3 + 걸 패편 확률
  51~100층: 은냥 5,000/층 + 걸 패편 2
  100층+:  은냥 10,000/층 + 각성석 확률

마일스톤 보상:
  10층: 옥패 30
  25층: 개봉권 1장
  50층: 옥패 100 + 별호 "탑의 도전자"
  100층: 옥패 300 + 별호 "탑의 정복자"
  200층: 옥패 500 + 한정 패 스킨
```

### 9-2. 일일 시련

> 상세 규칙은 [04_BattleSystem.md](04_BattleSystem.md) 참조

```
해금: 관문 36 돌파 (3장 두목)
주기: 매일 자정 룰 변경
도전: 하루 3회
난이도: 현재 최고 관문 기준 자동 조절
```

### 9-3. 패사 대전

> 상세 규칙은 [04_BattleSystem.md](04_BattleSystem.md) 참조

```
해금: 관문 24 돌파 (2장 두목)
방식: 비동기 PvP
일일 5회 무료 도전
```

### 9-4. 전설의 타짜 (숨겨진 두목)

```
해금: 관문 96 돌파 (스토리 완료)
주기: 매월 1회 새 전설의 타짜 등장

특징:
  - 관문 96 두목보다 2~3배 강력
  - 고유 패턴 + 페이즈 3단계
  - 특수 상태이상 사용 (복합 상태이상)

보상:
  - 첫 처치: 한정 별호 + 옥패 300 + 한정 패 스킨
  - 반복 처치: 각성석 5 + 옥패 50
```

---

## 10. 진행도 시스템

### 진행도 표시

```
┌──────────────────────────────────────────┐
│  📍 현재 위치: 제3장 호서 - 관문 28      │
│                                          │
│  ████████████████░░░░░░░░░░░░░  29.2%    │
│                                          │
│  ✅ 한양  ✅ 경기  ▶ 호서                │
│  ⬜ 호남  ⬜ 영남  ⬜ 관북               │
│  ⬜ 관서  ⬜ 한양 귀환                   │
└──────────────────────────────────────────┘
```

### 지도 UI

```
                  ┌─────────┐
                  │  관서   │
                  │ (7장)   │
                  └────┬────┘
    ┌─────────┐        │        ┌─────────┐
    │  관북   ├────────┤        │ 한양귀환 │
    │ (6장)   │        │        │ (8장)   │
    └────┬────┘   ┌────┴────┐   └────┬────┘
         │        │  한양   │        │
         │        │ (1장)   ├────────┘
         │        └────┬────┘
    ┌────┴────┐        │        ┌─────────┐
    │  영남   │   ┌────┴────┐   │  호서   │
    │ (5장)   │   │  경기   │   │ (3장)   │
    └────┬────┘   │ (2장)   │   └────┬────┘
         │        └────┬────┘        │
         │             │             │
         │        ┌────┴────┐        │
         └────────┤  호남   ├────────┘
                  │ (4장)   │
                  └─────────┘

  ● 완료 지역: 밝게 표시 + 별호 뱃지
  ▶ 현재 지역: 깜빡임 + 관문 진행 바
  ○ 미해금 지역: 어둡게 + 자물쇠
```

---

## 11. 데이터 모델

```
StageData {
    id: int                     // 관문 번호 (1~96+)
    chapter: int                // 장 번호 (1~8)
    region: Region              // 소속 지역
    type: StageType             // NORMAL / MINI_BOSS / CHAPTER_BOSS

    // 적 구성
    enemies: EnemySpawn[]       // 적 목록
    recommendedPower: int       // 권장 전투력

    // 보상
    clearReward: RewardData     // 매회 돌파 보상
    firstClearReward: RewardData // 첫 돌파 보상 (1회성)
    storyEvent: StoryData       // 스토리 컷신 (두목 관문만)

    // 해금
    unlockCondition: int        // 이전 관문 번호 (선행 조건)
    unlocksFeature: string[]    // 돌파 시 해금되는 기능 목록
}

EnemySpawn {
    enemyId: string             // 적 ID
    type: EnemyType             // MOB / ELITE / MINI_BOSS / BOSS
    level: int                  // 적 레벨
    paeType: PaeType            // 적 패 종류 (속성 결정)
}

PlayerProgress {
    highestStage: int           // 최고 돌파 관문
    currentIdleStage: int       // 현재 방치 수련 관문
    chapterProgress: {          // 장별 진행도
        chapter: int
        cleared: bool
        starsEarned: int        // (향후 별점 시스템 확장용)
    }[]
    unlockedFeatures: string[]  // 해금된 기능 목록
    towerHighest: int           // 투전탑 최고층
}
```
